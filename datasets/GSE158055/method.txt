Single-cell sequencing data were aligned and quantified using kallisto/bustools (KB, v0.24.4) . Unique molecular identifier (UMI) count matrices were imported into python (version 3.7.6) and were processed with python package Scanpy  (version 1.4.6).
Quality control was applied to cells based on three metrics step by step, including the total UMI counts, number of detected genes and proportion of mitochondrial gene counts per cell. Specifically, cells with less than 1000 UMI counts and 500 detected genes were filtered, as well as cells with more than 10% mitochondrial gene counts. To remove potential doublets, for PBMC samples, cells with UMI counts above 25,000 and detected genes above 5,000 are filtered out. For other tissues, cells with UMI counts above 70,000 and detected genes above 7,500 are filtered out. Additionally, we removed the potential doublets predicted by Scrublet (version 0.2.1), filtering cells with doubletScore > 0.25 as potential doublet. 
We normalized the UMI counts with the deconvolution strategy implemented in the R package scran. Specifically, cell-specific size factors were computed by computeSumFactors function, and  were further used to scale the counts in each cell. Then the normalized data were logarithmized.
